---
title: "Homework 6"
author: "aw3253"
date: "12/4/2021"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(modelr)
library(p8105.datasets)
library(viridis)

knitr::opts_chunk$set(echo = TRUE,
  warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"                    
  )

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
theme_set(theme_minimal() + theme(legend.position = "bottom"))
```


# Problem 1

Importing Data:

```{r}
birth =
  read_csv(file = "./data/birthweight.csv") %>% 
  drop_na()
```


Data Cleaning:

```{r}
birth_df =
birth %>% 
  mutate(babysex = factor(babysex,
                          levels = c(1, 2),
                          labels = c("Male", "Female"))) %>% 
  mutate(frace = factor(frace,
                        levels = c(1, 2, 3, 4, 8, 9),
                        labels = c("White", "Black", "Asian", "Puerto Rican", "Other", "Unknown"))) %>% 
  mutate(malform = factor(malform,
                          levels = c(0, 1),
                          labels = c("Absent", "Present"))) %>% 
  mutate(mrace = factor(mrace,
                        levels = c(1, 2, 3, 4, 8),
                        labels = c("White", "Black", "Asian", "Puerto Rican", "Other")))

birth_df
```


Proposed Model for Birthweight:

```{r}
fit= lm(bwt ~ gaweeks+ smoken + delwt + pnumlbw + wtgain + momage, data = birth_df)
fit %>% broom::tidy()
fit %>% broom::glance()
```

Significant Predictors?


Plotting Residuals:

```{r}
residual_plot =
birth_df %>% 
  add_predictions(fit) %>% 
  add_residuals(fit) %>% 
  ggplot(aes(x=pred, y=resid)) +
  geom_point()  +
  geom_smooth(method= "lm", se = FALSE) +
  labs(x= "Predicted Birthweight(grams)", y="Residual",title = "Predictions of Proposed Model vs Residuals")

residual_plot
```

The residuals are somewhat randomly scattered around 0, but there does seem to be a cluster indicating a pattern. Based on other assumptions, the model may still be appropriate. 


Comparing Models:

