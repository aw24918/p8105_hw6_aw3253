Homework 6
================
aw3253
12/4/2021

# Problem 1

Importing Data:

``` r
birth =
  read_csv(file = "./data/birthweight.csv") %>% 
  drop_na()
```

    ## Rows: 4342 Columns: 20

    ## -- Column specification --------------------------------------------------------
    ## Delimiter: ","
    ## dbl (20): babysex, bhead, blength, bwt, delwt, fincome, frace, gaweeks, malf...

    ## 
    ## i Use `spec()` to retrieve the full column specification for this data.
    ## i Specify the column types or set `show_col_types = FALSE` to quiet this message.

Data Cleaning:

``` r
birth_df =
birth %>% 
  mutate(babysex = factor(babysex,
                          levels = c(1, 2),
                          labels = c("Male", "Female"))) %>% 
  mutate(frace = factor(frace,
                        levels = c(1, 2, 3, 4, 8, 9),
                        labels = c("White", "Black", "Asian", "Puerto Rican", "Other", "Unknown"))) %>% 
  mutate(malform = factor(malform,
                          levels = c(0, 1),
                          labels = c("Absent", "Present"))) %>% 
  mutate(mrace = factor(mrace,
                        levels = c(1, 2, 3, 4, 8),
                        labels = c("White", "Black", "Asian", "Puerto Rican", "Other")))

birth_df
```

    ## # A tibble: 4,342 x 20
    ##    babysex bhead blength   bwt delwt fincome frace gaweeks malform menarche
    ##    <fct>   <dbl>   <dbl> <dbl> <dbl>   <dbl> <fct>   <dbl> <fct>      <dbl>
    ##  1 Female     34      51  3629   177      35 White    39.9 Absent        13
    ##  2 Male       34      48  3062   156      65 Black    25.9 Absent        14
    ##  3 Female     36      50  3345   148      85 White    39.9 Absent        12
    ##  4 Male       34      52  3062   157      55 White    40   Absent        14
    ##  5 Female     34      52  3374   156       5 White    41.6 Absent        13
    ##  6 Male       33      52  3374   129      55 White    40.7 Absent        12
    ##  7 Female     33      46  2523   126      96 Black    40.3 Absent        14
    ##  8 Female     33      49  2778   140       5 White    37.4 Absent        12
    ##  9 Male       36      52  3515   146      85 White    40.3 Absent        11
    ## 10 Male       33      50  3459   169      75 Black    40.7 Absent        12
    ## # ... with 4,332 more rows, and 10 more variables: mheight <dbl>, momage <dbl>,
    ## #   mrace <fct>, parity <dbl>, pnumlbw <dbl>, pnumsga <dbl>, ppbmi <dbl>,
    ## #   ppwt <dbl>, smoken <dbl>, wtgain <dbl>

Proposed Model for Birthweight:

``` r
fit= lm(bwt ~ gaweeks+ smoken + delwt + pnumlbw + wtgain + momage, data = birth_df)
fit %>% broom::tidy()
```

    ## # A tibble: 7 x 5
    ##   term        estimate std.error statistic    p.value
    ##   <chr>          <dbl>     <dbl>     <dbl>      <dbl>
    ## 1 (Intercept)  -203.      94.3       -2.16  3.11e-  2
    ## 2 gaweeks        58.9      2.17      27.1   8.06e-150
    ## 3 smoken         -7.52     0.909     -8.27  1.70e- 16
    ## 4 delwt           4.32     0.337     12.8   5.74e- 37
    ## 5 pnumlbw        NA       NA         NA    NA        
    ## 6 wtgain          5.88     0.688      8.55  1.69e- 17
    ## 7 momage         13.2      1.77       7.47  9.93e- 14

``` r
fit %>% broom::glance()
```

    ## # A tibble: 1 x 12
    ##   r.squared adj.r.squared sigma statistic   p.value    df  logLik    AIC    BIC
    ##       <dbl>         <dbl> <dbl>     <dbl>     <dbl> <dbl>   <dbl>  <dbl>  <dbl>
    ## 1     0.256         0.255  442.      299. 1.31e-275     5 -32606. 65225. 65270.
    ## # ... with 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>

Significant Predictors?

Plotting Residuals:

``` r
residual_plot =
birth_df %>% 
  add_predictions(fit) %>% 
  add_residuals(fit) %>% 
  ggplot(aes(x=pred, y=resid)) +
  geom_point()  +
  geom_smooth(method= "lm", se = FALSE) +
  labs(x= "Predicted Birthweight(grams)", y="Residual",title = "Predictions of Proposed Model vs Residuals")

residual_plot
```

    ## `geom_smooth()` using formula 'y ~ x'

<img src="p8105_hw6_aw3253_files/figure-gfm/unnamed-chunk-4-1.png" width="90%" />

The residuals are somewhat randomly scattered around 0, but there does
seem to be a cluster indicating a pattern. Based on other assumptions,
the model may still be appropriate.

Comparing Models:
